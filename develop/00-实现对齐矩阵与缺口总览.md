# 实现对齐矩阵与缺口总览

## 对齐信息

- 对齐基线：main@17f0f8c957a4c0f95ebb054725f04b21e0e6861b
- 实现状态：已落地
- 证据路径：`src/`、`include/`、`python/`、`scripts/`、`develop/`
- 最后更新：2026-02-11

## 1. 基线说明

本文档是 `develop/` 全量文档的唯一对齐入口。所有“当前已实现”判断均以 `main@17f0f8c957a4c0f95ebb054725f04b21e0e6861b` 为准。

## 2. 模块到代码映射

| 领域 | 当前实现入口 | 主要代码路径 | 对应文档 |
|---|---|---|---|
| CTP 接入与配置 | 已落地 | `include/quant_hft/core/ctp_config*.h`、`src/core/ctp/`、`src/apps/core_engine_main.cpp` | `03-02`、`05-01`、`06-01` |
| 风控 | 已落地（多层级策略 + 结构化审计） | `include/quant_hft/services/risk_policy_engine.h`、`src/services/risk/risk_policy_engine.cpp`、`include/quant_hft/contracts/types.h` | `03-01`、`05-01` |
| 订单状态机与执行 | 已落地（direct/sliced/twap/vwap_lite + 节流反馈） | `include/quant_hft/services/execution_planner.h`、`src/services/order/execution_planner.cpp`、`src/apps/core_engine_main.cpp` | `03-02`、`05-01` |
| 实时缓存/时序存储 | 已落地（in-memory + 外部驱动桥接） | `include/quant_hft/interfaces/realtime_cache.h`、`src/core/storage/redis_realtime_store*.cpp`、`src/core/storage/timescale_*` | `05-01`、`09-01` |
| 策略桥（Redis） | 已落地（轮询桥） | `src/core/common/strategy_intent_*`、`python/quant_hft/runtime/strategy_runner.py`、`docs/STRATEGY_BRIDGE_REDIS_PROTOCOL.md` | `05-02`、`06-01` |
| 回测回放 | 已落地（可复现 spec/result + 绩效摘要 + 场景模板 + 输入/数据签名 + 数据概览元信息 + CLI Markdown 报告 + 可选 StateSnapshot7D 派发） | `python/quant_hft/backtest/replay.py`、`scripts/backtest/replay_csv.py`、`python/tests/test_backtest_scenarios.py` | `02-02`、`02-03`、`05-02` |
| 数据管道（non-hotpath） | 已落地（字典校验 + 生命周期 + 对账） | `python/quant_hft/data_pipeline/`、`scripts/data_pipeline/run_pipeline.py`、`scripts/data_pipeline/run_lifecycle.py`、`scripts/data_pipeline/run_reconcile.py` | `07-01`、`09-01` |
| 运维渲染脚本与演练 | 已落地（systemd/k8s + 回滚模板 + Ops Health SLI + Redis 键链自动探测 + 发布包验包/审计摘要 Markdown+JSON+JSONL 索引/索引与摘要双校验 + WAL 演练证据校验 + 部署回滚演练证据校验 + 多机主备切换演练编排与证据校验 + 仓库内 prodlike 依赖栈自建入口 + 单机生产 SLA 基线） | `scripts/ops/render_systemd_units.py`、`scripts/ops/render_k8s_manifests.py`、`python/quant_hft/ops/monitoring.py`、`scripts/ops/run_reconnect_evidence.py`、`scripts/ops/reconnect_slo_report.py`、`scripts/ops/fake_redis_bridge_server.py`、`scripts/ops/verify_wal_recovery_evidence.py`、`scripts/ops/verify_deploy_rollback_evidence.py`、`scripts/ops/failover_orchestrator.py`、`scripts/ops/verify_failover_evidence.py`、`scripts/infra/bootstrap_prodlike.sh`、`scripts/infra/check_prodlike_health.py`、`scripts/infra/bootstrap_prodlike_multi_host.sh`、`scripts/infra/check_prodlike_multi_host_health.py`、`infra/docker-compose.prodlike.yaml`、`infra/docker-compose.prodlike.multi-host.yaml`、`scripts/build/verify_nonhotpath_release.py`、`scripts/build/release_audit_summary.py`、`scripts/build/release_audit_index.py`、`scripts/build/verify_release_audit_summary.py`、`scripts/build/verify_release_audit_index.py`、`docs/*RUNBOOK*.md`、`docs/templates/WAL_RECOVERY_RESULT.md`、`docs/templates/DEPLOY_ROLLBACK_RESULT.md`、`docs/results/failover_result.env` | `04-01`、`07-01`、`07-02` |
| 性能基础组件 | 已落地（对象池 + benchmark + perf smoke） | `include/quant_hft/core/object_pool.h`、`src/core/perf/object_pool.cpp`、`src/apps/hotpath_benchmark_main.cpp`、`scripts/perf/run_hotpath_bench.py` | `03-03`、`08-01` |
| CI 与质量门禁 | 已落地（含 fake redis 驱动 ops smoke + release 审计校验 + perf smoke） | `.github/workflows/ci.yml`、`.github/workflows/release-package.yml`、`scripts/build/bootstrap.sh`、`scripts/ops/fake_redis_bridge_server.py`、`scripts/perf/run_hotpath_bench.py` | `06-02`、`08-01` |

## 3. develop 文档状态矩阵（21 篇）

| 文档 | 状态 | 说明 |
|---|---|---|
| `develop/00-项目总览与设计原则.md` | 已落地（仓库范围） | 总体方向、主链路与验收方式已与仓库实现一致。 |
| `develop/01-系统架构设计/01-01-整体架构图与技术栈选型.md` | 已落地（仓库范围） | 架构与技术栈选型可映射到当前代码目录与运行入口。 |
| `develop/01-系统架构设计/01-02-核心模块划分与职责.md` | 已落地（仓库范围） | 模块边界与职责已在 `include/`、`src/`、`python/` 目录实现并可追溯。 |
| `develop/01-系统架构设计/01-03-关键数据流与接口设计.md` | 已落地（仓库范围） | 主数据流与失败分支均有实现路径、校验脚本与证据。 |
| `develop/02-策略研究平台设计/02-01-研究环境与数据接口规范.md` | 已落地（仓库范围） | 研究接口、回放 spec/result 契约、数据签名与脚本入口均已落地。 |
| `develop/02-策略研究平台设计/02-02-因子研究与回测引擎设计.md` | 已落地（仓库范围） | 因子目录、实验追踪、回测引擎与模板场景已形成可复现闭环。 |
| `develop/02-策略研究平台设计/02-03-策略模版与绩效分析体系.md` | 已落地（仓库范围） | 模板体系、绩效指标字典、归因与风险分解字段已在回测结果契约落地。 |
| `develop/03-实盘交易系统核心设计/03-01-实时风控体系设计.md` | 已落地（仓库范围） | 多层级规则、敞口评估、策略重载与结构化审计已落地。 |
| `develop/03-实盘交易系统核心设计/03-02-订单与执行引擎设计.md` | 已落地（仓库范围） | direct/sliced/twap/vwap_lite 与路由反馈闭环已落地。 |
| `develop/03-实盘交易系统核心设计/03-03-高性能基础组件设计（内存管理、网络等）.md` | 已落地（仓库范围） | 对象池、热点基准与性能回归门禁已落地。 |
| `develop/04-基础设施与运维/04-01-监控、日志与告警体系设计.md` | 已落地（仓库范围） | SLI/SLO、告警策略与 prodlike 可观测栈脚本入口已落地。 |
| `develop/04-基础设施与运维/04-02-部署、灾备与持续集成方案.md` | 已落地（仓库范围） | CI、发布审计、回滚/WAL 校验、单机生产 SLA 验收流程与 prodlike 编排入口已落地。 |
| `develop/05-API文档/05-01-C++核心API参考.md` | 已落地 | 与当前头文件和实现一致。 |
| `develop/05-API文档/05-02-Python策略API参考.md` | 已落地 | 与 Python 包和 runner 一致。 |
| `develop/06-开发者指南/06-01-环境搭建与快速开始.md` | 已落地 | 命令与目录可执行。 |
| `develop/06-开发者指南/06-02-代码结构与开发流程.md` | 已落地 | 目录与门禁对齐。 |
| `develop/06-开发者指南/06-03-文档开发与多会话协作.md` | 已落地 | 用途明确，仅文档协作语境。 |
| `develop/07-部署与运维/07-01-系统部署手册.md` | 已落地 | 对齐当前交付物与 runbook。 |
| `develop/07-部署与运维/07-02-运维操作手册.md` | 已落地（仓库范围） | 单机生产环境预检、重连、WAL、回滚、编排与证据校验 SOP 已可执行。 |
| `develop/08-测试与验证/08-01-测试策略与验证方案.md` | 已落地 | 与当前 CI/本地门禁一致。 |
| `develop/09-数据库设计/09-01-数据库设计.md` | 已落地（仓库范围） | Redis/Timescale/分析归档与生命周期/对账脚本已形成仓库闭环。 |

## 4. 收敛检查清单

1. `develop/` 文档统一使用“已落地（仓库范围）”语义，并由 `scripts/build/verify_develop_requirements.py` 自动校验完成语义一致性。
2. 跨语言契约字段变更由 `scripts/build/verify_contract_sync.py` 门禁保护，避免 C++/Python/proto 漂移。
3. 运维能力以“可执行脚本 + 证据文件”闭环为准，证据保存在 `docs/results/`。
4. 扩展部署规模时保持同一接口与证据协议，避免文档先行宣布能力状态。

## 5. 生产口径说明（当前）

1. 当前交付口径是单机生产基线：支持单台 PC 或云上单实例主机完成发布、监控、回滚、恢复与证据闭环。
2. 多机主备切换演练与证据校验已在仓库范围落地；多活容灾作为后续迭代项保留在路线图。
3. 任一口径调整都必须同步 `develop/00-*` 与 `develop/04-*`、`develop/07-*` 文档，并附脚本与证据路径。

## 6. 使用方式

1. 先看本页判断文档状态，再进入对应章节。
2. 若章节标注为“已落地（仓库范围）”，按仓库可执行范围使用，并单独评估外部依赖项。
3. 若要新增实现，先更新 `develop/00-未完成能力补齐路线图.md` 再改专项文档。
