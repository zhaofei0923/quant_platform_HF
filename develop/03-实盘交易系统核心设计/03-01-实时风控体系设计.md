# 实时风控体系设计

## 对齐信息

- 对齐基线：main@17f0f8c957a4c0f95ebb054725f04b21e0e6861b
- 实现状态：已落地（仓库范围）
- 证据路径：`src/services/risk/basic_risk_engine.cpp`、`include/quant_hft/interfaces/risk_engine.h`、`tests/unit/services/basic_risk_engine_test.cpp`
- 最后更新：2026-02-11

## 当前实现边界

已落地风控能力以基础预检查为主：
- `BasicRiskEngine::PreCheck` 对订单意图执行规则校验。
- 风控结果进入 `ITimeseriesStore::AppendRiskDecision`。
- `core_engine_main` 对放行/拒绝路径均可写回订单事件。

尚未落地：多层级风险限额、跨账户敞口聚合、在线参数下发。

## 当前规则能力（已实现）

1. 基础字段合法性与数值边界检查。
2. 与订单状态机解耦的风控接口抽象。
3. 风控决策可审计落盘（reason/rule_id/action）。

## 规划内容（未落地）

1. 按账户/品种/时段的差异化限额体系。
2. 连续亏损与异常交易行为检测。
3. 风控参数热更新与版本追踪。

## 落地依赖条件

- 需要账户维度持仓/资金口径统一。
- 需要风险规则配置中心与审计机制。
- 需要回放场景覆盖“拒绝/放行/部分成交”。

## 进入实现阶段触发条件

- 新规则有明确输入字段和失败语义。
- 规则可通过单测与回放场景复现。
- 风控变更附带回滚与开关策略。
