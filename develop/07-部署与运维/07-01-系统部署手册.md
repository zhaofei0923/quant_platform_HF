# 系统部署手册

## 对齐信息

- 对齐基线：main@f1f98c884be1538c06acff265f2904745175be96
- 实现状态：已落地
- 证据路径：`docs/SYSTEMD_DEPLOYMENT_RUNBOOK.md`、`docs/K8S_DEPLOYMENT_RUNBOOK.md`、`scripts/infra/bootstrap_prodlike.sh`
- 最后更新：2026-02-17

## 概述

本文档描述当前可用的部署方式与交付物范围（纯 C++ 运行链路）。

当前部署单元：
- `core_engine`（核心交易进程）
- 研究与运维 CLIs（回测、报告、演练）

详细步骤参见：
- systemd：`docs/SYSTEMD_DEPLOYMENT_RUNBOOK.md`
- Kubernetes（非热路径）：`docs/K8S_DEPLOYMENT_RUNBOOK.md`

## 1. 部署前准备

### 1.1 构建与验证

```bash
./scripts/build/bootstrap.sh
```

### 1.2 配置文件

CTP 运行配置：
- `configs/sim/ctp.yaml`
- `configs/sim/ctp_trading_hours.yaml`
- `configs/dev/ctp.yaml`
- `configs/prod/ctp.yaml`

## 2. 单机运行（开发/验证）

```bash
export CTP_SIM_PASSWORD='your_password'
./build/core_engine configs/sim/ctp.yaml
```

可选探针：

```bash
./build/simnow_probe configs/sim/ctp_trading_hours.yaml
```

## 3. systemd 部署（推荐）

- 安装与启动步骤：`docs/SYSTEMD_DEPLOYMENT_RUNBOOK.md`
- 回滚与证据模板：`docs/templates/DEPLOY_ROLLBACK_RESULT.md`

## 4. Kubernetes 部署（非热路径）

- 参考流程：`docs/K8S_DEPLOYMENT_RUNBOOK.md`
- 建议先在 preprod 走完整演练，再推广到生产环境。
